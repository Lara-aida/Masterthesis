---
title: "Evaluation of Socio Demographic Results"
output: html_notebook
---

This is the evaluation of the experiment's socio demographic results. It expands the master thesis by data analysis and respective code as well as short explanations. This markdown does not replace the thesis, it serves solely as an appendix.

<h1>Library Downloads</h1>
```{r}
library(tidyverse)
library(broom)
library(ggplot2)
library(dplyr)
```


<h1>Sample Description: Socio Demographics</h1>
First, the final sample is loaded:

```{r}
getwd()
raw_data <- readxl::read_excel("data/raw_data.xlsx", sheet = 2)
view(raw_data)
glimpse(raw_data)
```
Out of the raw data, we can at least analyze the socio demographics of each participant to validate if the sample is representative.

```{r}
socio_demographics <- raw_data[, c("SD01", "SD02", "SD04", "SD04_14", "SD05")]

socio_demographics <- rename(socio_demographics, sex = SD01, age_group_years = SD02, degree = SD04, degree_special = SD04_14, employment = SD05)

socio_demographics <- socio_demographics %>%
  mutate(
    sex = factor(sex, 
                 labels = c("Female", "Male")),
)

glimpse(socio_demographics)
```
Based on that the share of sex is evaluated:

```{r}

sex <- socio_demographics %>%
  group_by(sex) %>%
  summarise(
    absolute_count = n()
  ) %>%
  mutate(relative_share_percent = round(100 * absolute_count / sum(absolute_count), 0)
  )

glimpse(sex)
  
```
Now, the age is evaluated and plotted using a bar plot showing the absolute count:

```{r}
age_group_labels <- c("<18", "19-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", ">65")

age <- socio_demographics %>%
  sort_by(socio_demographics$age_group_years) %>%
  mutate(age_group_years = factor(age_group_years, labels = age_group_labels))

ggplot(data = age, aes(x=age_group_years)) + geom_bar(fill=rgb(0.1,0.4,0.5,1))

glimpse(age)
```
The following shows the age group distribution in percentage:

```{r}
age_group_labels <- c("<18", "19-24", "25-29", "30-34", "35-39", "40-44", "45-49", "50-54", "55-59", "60-64", ">65")

age <- socio_demographics %>%
    sort_by(socio_demographics$age_group_years) %>%
  mutate(age_group_years = factor(age_group_years, labels = age_group_labels)) %>%
  group_by(age_group_years) %>%
  summarise(absolute_count = n()
  ) %>%
  mutate(relative_share_percent= round(100 * absolute_count / sum(absolute_count), 2))

view(age)
```

Since the age group has been conducted, the degree is evaluated next:

```{r}
degree_labels <- c("School-Student", "German: Hauptschule", "German: Mittlere Reife", "German: Ausbildungsabschluss", "Technical High School Diploma", "High School Diploma", "Bachelor Professional", "Master Craftsman", "Bachelor's", "Master's", "Diploma", "Doctorate", "Else")

degree <- socio_demographics %>%
  sort_by(socio_demographics$degree) %>%
  mutate(degree = factor(degree, labels = degree_labels)) 

ggplot(data = degree, aes(x=degree)) + geom_bar(fill=rgb(0.1,0.4,0.5,1)) + 
coord_flip()

glimpse(degree)
```
The following shows the degree distribution in percentage:

```{r}
degree_labels <- c("School-Student", "German: Hauptschule", "German: Mittlere Reife", "German: Ausbildungsabschluss", "Technical High School Diploma", "High School Diploma", "Bachelor Professional", "Master Craftsman", "Bachelor's", "Master's", "Diploma", "Doctorate", "Else")

degree <- socio_demographics %>%
    sort_by(socio_demographics$degree) %>%
  mutate(degree = factor(degree, labels = degree_labels)) %>%
  group_by(degree) %>%
  summarise(
    absolute_count = n(),
    degree_special = if (first(degree) == "Else") {
      paste(sort(degree_special), collapse = ", ")
    } else {
      ""
    }
  ) %>%
  mutate(relative_share_percent = round(100 * absolute_count / sum(absolute_count), 2))

view(degree)
```

Finally the employment status is evaluated:

```{r}
employment_labels <- c("Pupil", "In Training", "Student", "Employee", "Civil Servant", "Self-Employed", "Pensioner")

employment <- socio_demographics %>%
  sort_by(socio_demographics$employment) %>%
  mutate(employment = factor(employment, labels = employment_labels)) 

ggplot(data = employment, aes(x=employment)) + geom_bar(fill=rgb(0.1,0.4,0.5,1)) + coord_flip()
  
view(employment)
```

The following shows the employment distribution in percentage:

```{r}
employment_labels <- c("Pupil", "In Training", "Student", "Employee", "Civil Servant", "Self-Employed", "Pensioner")

employment <- socio_demographics %>%
  sort_by(socio_demographics$employment) %>%
  mutate(employment = factor(employment, labels = employment_labels)) %>%
  group_by(employment) %>%
  summarise(absolute_count = n()
  ) %>%
  mutate(relative_share_percent= round(100 * absolute_count / sum(absolute_count), 2))

view(employment)
```

